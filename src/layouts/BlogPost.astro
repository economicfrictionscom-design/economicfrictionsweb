---
import BaseLayout from './BaseLayout.astro';
import Subscribe from '../components/Subscribe.astro';
import Comments from '../components/Comments.astro';

const { title, description, pubDate } = Astro.props;
---

<BaseLayout title={title} description={description} wide={true}>
  
  <article class="max-w-4xl mx-auto mt-16 mb-24 px-6">
    
    <header class="text-left mb-16">
      <div class="text-amber-600 dark:text-amber-500 font-bold text-xs md:text-sm tracking-[0.25em] uppercase mb-6">
        {pubDate && new Date(pubDate).toLocaleDateString('en-US', {
          year: 'numeric',
          month: 'long',
          day: 'numeric',
        })}
      </div>

      <h1 class="text-4xl md:text-6xl lg:text-7xl font-serif font-bold text-slate-900 dark:text-white leading-tight tracking-wide mb-8">
        {title}
      </h1>

      <p class="text-xl md:text-2xl text-slate-500 dark:text-slate-400 italic font-serif leading-relaxed max-w-2xl mb-10">
        {description}
      </p>

      <hr class="w-24 border-t-2 border-amber-400 opacity-60 ml-0" />
    </header>

    <div class="prose dark:prose-invert max-w-none font-serif text-lg md:text-xl text-slate-700 dark:text-slate-300">
      <slot />
    </div>

    <div class="mt-20 border-t border-slate-200 dark:border-slate-800 pt-10">
      
      <div class="text-center mb-16">
        <p class="text-slate-400 text-sm font-bold tracking-widest uppercase mb-4">Share this essay</p>
        <div class="flex justify-center gap-4">
          <button onclick="navigator.clipboard.writeText(window.location.href); alert('Link copied!')" class="px-4 py-2 bg-slate-100 dark:bg-slate-800 rounded-full text-slate-600 dark:text-slate-300 text-xs font-bold hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors">
            Copy Link
          </button>
          <a href={`https://www.linkedin.com/sharing/share-offsite/?url=CURRENT_URL`} target="_blank" class="px-4 py-2 bg-slate-100 dark:bg-slate-800 rounded-full text-slate-600 dark:text-slate-300 text-xs font-bold hover:bg-blue-50 dark:hover:bg-blue-900/30 hover:text-blue-600 transition-colors">
            LinkedIn
          </a>
        </div>
      </div>

      <div class="mb-16">
         <h3 class="font-serif font-bold text-2xl text-slate-900 dark:text-white mb-8">Discussion</h3>
         <Comments />
      </div>

      <div>
        <Subscribe />
      </div>
      
    </div>
  </article>

  <script is:inline>
    // Simple logic to ensure the share link uses the current URL
    const url = encodeURIComponent(window.location.href);
    document.querySelectorAll('a[href*="CURRENT_URL"]').forEach(link => {
      link.href = link.href.replace('CURRENT_URL', url);
    });
  </script>
</BaseLayout>