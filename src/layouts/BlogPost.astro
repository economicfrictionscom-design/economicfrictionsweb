---
import type { CollectionEntry } from 'astro:content';
import BaseLayout from './BaseLayout.astro';
import FormattedDate from '../components/FormattedDate.astro';
// 1. RESTORED: Import the missing components
import Comments from '../components/Comments.astro';
import Subscribe from '../components/Subscribe.astro';

type Props = CollectionEntry<'blog'>['data'];

const { title, description, pubDate, updatedDate, heroImage } = Astro.props;
---

<BaseLayout title={title} description={description}>
  <article class="max-w-4xl mx-auto">
    
    <div class="mb-12 text-center">
      {/* 2. MOVED: Title & Date now come FIRST (Top) */}
      <div class="space-y-4 mb-8">
        <div class="text-slate-500 dark:text-slate-400 font-mono text-sm uppercase tracking-wider">
          <FormattedDate date={pubDate} />
          {updatedDate && (
            <div class="italic">
              Last updated on <FormattedDate date={updatedDate} />
            </div>
          )}
        </div>
        <h1 class="text-4xl md:text-6xl font-serif font-bold text-slate-900 dark:text-white leading-tight">
          {title}
        </h1>
      </div>

      {/* 3. MOVED: Hero Image is now BELOW the title */}
      {heroImage && (
        <img 
          width={1020} 
          height={510} 
          src={heroImage} 
          alt="" 
          class="rounded-xl shadow-lg border border-slate-200 dark:border-slate-800 mx-auto" 
        />
      )}
      
      <hr class="border-t border-slate-200 dark:border-slate-800 my-12 w-24 mx-auto" />
    </div>

    {/* Content Area */}
    <div class="prose prose-lg dark:prose-invert font-serif max-w-none text-slate-800 dark:text-slate-300 leading-relaxed mx-auto">
      <slot />
    </div>

    {/* 4. RESTORED: Subscribe & Comments at the bottom */}
    <div class="mt-20 border-t border-slate-200 dark:border-slate-800 pt-10">
      <Subscribe />
      <div class="mt-12">
        <Comments />
      </div>
    </div>

  </article>
</BaseLayout>